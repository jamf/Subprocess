<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Subprocess  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="Subprocess  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">Subprocess Docs</a> (100% documented)</p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">Subprocess Reference</a>
        <img id="carat" src="img/carat.png" />
        Subprocess  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/Shell.html">Shell</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Shell/OutputOptions.html">– OutputOptions</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Subprocess.html">Subprocess</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/SubprocessError.html">SubprocessError</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/SubprocessDependencyFactory.html">SubprocessDependencyFactory</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/Input.html">Input</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/Input/Value.html">– Value</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/SubprocessDependencyBuilder.html">SubprocessDependencyBuilder</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='subprocess' class='heading'>Subprocess</h1>

<p><img src="https://github.com/jamf/Subprocess/workflows/Build%20&%20Test/badge.svg" alt="Build">
<a href="http://mit-license.org"><img src="http://img.shields.io/badge/license-MIT-lightgrey.svg?style=flat" alt="License"></a>
<a href="https://developer.apple.com/macos"><img src="https://img.shields.io/badge/platform-macOS-lightgrey.svg?style=flat" alt="Platform"></a>
<a href="https://developer.apple.com/swift"><img src="http://img.shields.io/badge/language-Swift-lightgrey.svg?style=flat" alt="Language"></a>
<a href="https://github.com/Carthage/Carthage"><img src="https://img.shields.io/badge/Carthage-compatible-4BC51D.svg?style=flat" alt="Carthage compatible"></a>
<a href="https://swift.org/package-manager"><img src="https://img.shields.io/badge/spm-compatible-brightgreen.svg?style=flat" alt="SwiftPM compatible"></a></p>

<ul>
<li><a href="#usage">Usage</a>

<ul>
<li><a href="#shell-class">Shell</a>

<ul>
<li><a href="#command-input">Input</a> - <a href="#input-for-data">Data</a>, <a href="#input-for-text">Text</a>, <a href="#input-for-file-url">File</a></li>
<li><a href="#command-output">Output</a> - <a href="#output-as-data">Data</a>, <a href="#output-as-string">Text</a>, <a href="#output-as-json">JSON</a>, <a href="#output-as-decodable-object-from-json">Decodable JSON object</a>, <a href="#output-as-property-list">Property list</a>, <a href="#output-as-decodable-object-from-property-list">Decodable property list object</a></li>
</ul></li>
<li><a href="#subprocess-class">Subprocess</a></li>
</ul></li>
<li><a href="#installation">Installation</a>

<ul>
<li><a href="#swiftpm">SwiftPM</a></li>
<li><a href="#cocoapods">Cocoapods</a></li>
<li><a href="#carthage">Carthage</a></li>
</ul></li>
</ul>
<h1 id='usage' class='heading'>Usage</h1>
<h3 id='shell-class' class='heading'>Shell Class</h3>

<p>The Shell class can be used for synchronous command execution.</p>
<h4 id='command-input' class='heading'>Command Input</h4>
<h6 id='input-for-data' class='heading'>Input for data</h6>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">inputData</span><span class="p">:</span> <span class="kt">Data</span> <span class="o">=</span> <span class="o">...</span>
<span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">Shell</span><span class="p">([</span><span class="s">"/usr/bin/grep"</span><span class="p">,</span> <span class="s">"Hello"</span><span class="p">])</span><span class="o">.</span><span class="nf">exec</span><span class="p">(</span><span class="nv">input</span><span class="p">:</span> <span class="o">.</span><span class="nf">data</span><span class="p">(</span><span class="n">inputData</span><span class="p">))</span>
</code></pre>
<h6 id='input-for-text' class='heading'>Input for text</h6>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">Shell</span><span class="p">([</span><span class="s">"/usr/bin/grep"</span><span class="p">,</span> <span class="s">"Hello"</span><span class="p">])</span><span class="o">.</span><span class="nf">exec</span><span class="p">(</span><span class="nv">input</span><span class="p">:</span> <span class="o">.</span><span class="nf">text</span><span class="p">(</span><span class="s">"Hello world"</span><span class="p">))</span>
</code></pre>
<h6 id='input-for-file-url' class='heading'>Input for file URL</h6>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">url</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">fileURLWithPath</span><span class="p">:</span> <span class="s">"/path/to/input/file"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">Shell</span><span class="p">([</span><span class="s">"/usr/bin/grep"</span><span class="p">,</span> <span class="s">"foo"</span><span class="p">])</span><span class="o">.</span><span class="nf">exec</span><span class="p">(</span><span class="nv">input</span><span class="p">:</span> <span class="o">.</span><span class="nf">file</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="n">url</span><span class="p">))</span>
</code></pre>
<h6 id='input-for-file-path' class='heading'>Input for file path</h6>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">Shell</span><span class="p">([</span><span class="s">"/usr/bin/grep"</span><span class="p">,</span> <span class="s">"foo"</span><span class="p">])</span><span class="o">.</span><span class="nf">exec</span><span class="p">(</span><span class="nv">input</span><span class="p">:</span> <span class="o">.</span><span class="nf">file</span><span class="p">(</span><span class="nv">path</span><span class="p">:</span> <span class="s">"/path/to/input/file"</span><span class="p">))</span>
</code></pre>
<h4 id='command-output' class='heading'>Command Output</h4>
<h6 id='output-as-data' class='heading'>Output as Data</h6>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">Shell</span><span class="p">([</span><span class="s">"/usr/bin/sw_vers"</span><span class="p">])</span><span class="o">.</span><span class="nf">exec</span><span class="p">()</span>
</code></pre>
<h6 id='output-as-string' class='heading'>Output as String</h6>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">text</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">Shell</span><span class="p">([</span><span class="s">"/usr/bin/sw_vers"</span><span class="p">])</span><span class="o">.</span><span class="nf">exec</span><span class="p">(</span><span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span>
</code></pre>
<h6 id='output-as-json-array-or-dictionary' class='heading'>Output as JSON (Array or Dictionary)</h6>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">command</span> <span class="o">=</span> <span class="p">[</span><span class="s">"/usr/bin/log"</span><span class="p">,</span> <span class="s">"show"</span><span class="p">,</span> <span class="s">"--style"</span><span class="p">,</span> <span class="s">"json"</span><span class="p">,</span> <span class="s">"--last"</span><span class="p">,</span> <span class="s">"5m"</span><span class="p">]</span>
<span class="k">let</span> <span class="nv">logs</span><span class="p">:</span> <span class="p">[[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">Shell</span><span class="p">(</span><span class="n">command</span><span class="p">)</span><span class="o">.</span><span class="nf">execJSON</span><span class="p">())</span>
</code></pre>
<h6 id='output-as-decodable-object-from-json' class='heading'>Output as decodable object from JSON</h6>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">LogMessage</span><span class="p">:</span> <span class="kt">Codable</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">subsystem</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">category</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">machTimestamp</span><span class="p">:</span> <span class="kt">UInt64</span>
<span class="p">}</span>
<span class="k">let</span> <span class="nv">command</span> <span class="o">=</span> <span class="p">[</span><span class="s">"/usr/bin/log"</span><span class="p">,</span> <span class="s">"show"</span><span class="p">,</span> <span class="s">"--style"</span><span class="p">,</span> <span class="s">"json"</span><span class="p">,</span> <span class="s">"--last"</span><span class="p">,</span> <span class="s">"5m"</span><span class="p">]</span>
<span class="k">let</span> <span class="nv">logs</span><span class="p">:</span> <span class="p">[</span><span class="kt">LogMessage</span><span class="p">]</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">Shell</span><span class="p">(</span><span class="n">command</span><span class="p">)</span><span class="o">.</span><span class="nf">exec</span><span class="p">(</span><span class="nv">decoder</span><span class="p">:</span> <span class="kt">JSONDecoder</span><span class="p">())</span>
</code></pre>
<h6 id='output-as-property-list-array-or-dictionary' class='heading'>Output as Property List (Array or Dictionary)</h6>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">command</span> <span class="o">=</span> <span class="p">[</span><span class="s">"/bin/cat"</span><span class="p">,</span> <span class="s">"/System/Library/CoreServices/SystemVersion.plist"</span><span class="p">]</span>
<span class="k">let</span> <span class="nv">dictionary</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">Shell</span><span class="p">(</span><span class="n">command</span><span class="p">)</span><span class="o">.</span><span class="nf">execPropertyList</span><span class="p">())</span>
</code></pre>
<h6 id='output-as-decodable-object-from-property-list' class='heading'>Output as decodable object from Property List</h6>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">SystemVersion</span><span class="p">:</span> <span class="kt">Codable</span> <span class="p">{</span>
    <span class="kd">enum</span> <span class="kt">CodingKeys</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="kt">CodingKey</span> <span class="p">{</span>
        <span class="k">case</span> <span class="n">version</span> <span class="o">=</span> <span class="s">"ProductVersion"</span>
    <span class="p">}</span>
    <span class="k">var</span> <span class="nv">version</span><span class="p">:</span> <span class="kt">String</span>
<span class="p">}</span>
<span class="k">let</span> <span class="nv">command</span> <span class="o">=</span> <span class="p">[</span><span class="s">"/bin/cat"</span><span class="p">,</span> <span class="s">"/System/Library/CoreServices/SystemVersion.plist"</span><span class="p">]</span>
<span class="k">let</span> <span class="nv">result</span><span class="p">:</span> <span class="kt">SystemVersion</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">Shell</span><span class="p">(</span><span class="n">command</span><span class="p">)</span><span class="o">.</span><span class="nf">exec</span><span class="p">(</span><span class="nv">decoder</span><span class="p">:</span> <span class="kt">PropertyListDecoder</span><span class="p">())</span>
</code></pre>
<h6 id='output-mapped-to-other-type' class='heading'>Output mapped to other type</h6>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">enabled</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">Shell</span><span class="p">([</span><span class="s">"csrutil"</span><span class="p">,</span> <span class="s">"status"</span><span class="p">])</span><span class="o">.</span><span class="nf">exec</span><span class="p">(</span><span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span> <span class="p">{</span> <span class="n">_</span><span class="p">,</span> <span class="n">txt</span> <span class="k">in</span> <span class="n">txt</span><span class="o">.</span><span class="nf">contains</span><span class="p">(</span><span class="s">"enabled"</span><span class="p">)</span> <span class="p">}</span>
</code></pre>
<h6 id='output-options' class='heading'>Output options</h6>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">command</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
<span class="k">let</span> <span class="nv">errorText</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">Shell</span><span class="p">(</span><span class="n">command</span><span class="p">)</span><span class="o">.</span><span class="nf">exec</span><span class="p">(</span><span class="nv">options</span><span class="p">:</span> <span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">outputText</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">Shell</span><span class="p">(</span><span class="n">command</span><span class="p">)</span><span class="o">.</span><span class="nf">exec</span><span class="p">(</span><span class="nv">options</span><span class="p">:</span> <span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="nv">encoding</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">combinedData</span> <span class="o">=</span> <span class="k">try</span> <span class="kt">Shell</span><span class="p">(</span><span class="n">command</span><span class="p">)</span><span class="o">.</span><span class="nf">exec</span><span class="p">(</span><span class="nv">options</span><span class="p">:</span> <span class="o">.</span><span class="n">combined</span><span class="p">)</span>
</code></pre>
<h3 id='subprocess-class' class='heading'>Subprocess Class</h3>

<p>The Subprocess class can be used for asynchronous command execution.</p>
<h6 id='handling-output-as-it-is-read' class='heading'>Handling output as it is read</h6>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">command</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
<span class="k">let</span> <span class="nv">process</span> <span class="o">=</span> <span class="kt">Subprocess</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

<span class="c1">// The outputHandler and errorHandler are invoked serially</span>
<span class="k">try</span> <span class="n">process</span><span class="o">.</span><span class="nf">launch</span><span class="p">(</span><span class="nv">outputHandler</span><span class="p">:</span> <span class="p">{</span> <span class="n">data</span> <span class="k">in</span>
    <span class="c1">// Handle new data read from stdout</span>
<span class="p">},</span> <span class="nv">errorHandler</span><span class="p">:</span> <span class="p">{</span> <span class="n">data</span> <span class="k">in</span>
    <span class="c1">// Handle new data read from stderr</span>
<span class="p">},</span> <span class="nv">terminationHandler</span><span class="p">:</span> <span class="p">{</span> <span class="n">process</span> <span class="k">in</span>
    <span class="c1">// Handle process termination, all scheduled calls to</span>
    <span class="c1">// the outputHandler and errorHandler are guaranteed to</span>
    <span class="c1">// have completed.</span>
<span class="p">})</span>
</code></pre>
<h6 id='handling-output-on-termination' class='heading'>Handling output on termination</h6>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">command</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
<span class="k">let</span> <span class="nv">process</span> <span class="o">=</span> <span class="kt">Subprocess</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

<span class="k">try</span> <span class="n">process</span><span class="o">.</span><span class="n">launch</span> <span class="p">{</span> <span class="p">(</span><span class="n">process</span><span class="p">,</span> <span class="n">outputData</span><span class="p">,</span> <span class="n">errorData</span><span class="p">)</span> <span class="k">in</span>
    <span class="k">if</span> <span class="n">process</span><span class="o">.</span><span class="n">exitCode</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
        <span class="c1">// Do something with output data</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// Handle failure</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h2 id='installation' class='heading'>Installation</h2>
<h3 id='swiftpm' class='heading'>SwiftPM</h3>
<pre class="highlight swift"><code><span class="nv">dependencies</span><span class="p">:</span> <span class="p">[</span>
    <span class="o">.</span><span class="nf">package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/jamf/Subprocess.git"</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="s">"1.0.0"</span><span class="p">)</span>
<span class="p">]</span>
</code></pre>
<h3 id='cocoapods' class='heading'>Cocoapods</h3>
<pre class="highlight ruby"><code><span class="n">pod</span> <span class="s1">'Subprocess'</span>
</code></pre>
<h3 id='carthage' class='heading'>Carthage</h3>
<pre class="highlight ruby"><code><span class="n">github</span> <span class="s1">'jamf/Subprocess'</span>
</code></pre>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2020 <a class="link" href="https://github.com/jamf/Subprocess" target="_blank" rel="external">Cyrus Ingraham</a>. All rights reserved. (Last updated: 2020-03-09)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.1</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
